<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>正文编辑</title>
		<link rel="stylesheet" type="text/css" href="../modules/bootstrap-3.3.7-dist/css/bootstrap.min.css" />
		<link rel="stylesheet" type="text/css" href="../static/common/cms.css" />
		<style type="text/css">
			nav>ul>li:nth-child(2)>a {
				background-color: #2286d2;
			}
		</style>
	</head>
	<body>
		<div include="../static/nav.htm"></div>

		<div id="cedit" class="block">
			<div class="panel panel-info" style="margin: 8px 20px 0 20px;">
				<div class="panel-heading">
					正文编辑
				</div>
				<div class="panel-body">
					<form @submit.prevent="submitContext" class="form-horizontal" action="context.html">
						<div class="form-group">
							<label for="cname" class="col-sm-1 control-label">名称:</label>
							<div class="col-sm-11">
								<input type="text" class="form-control" v-model="cname" id="cname" placeholder="请输入正文名称">
							</div>
						</div>
						<div class="form-group">
							<label for="inputPassword3" class="col-sm-1 control-label">分类:</label>
							<div class="col-sm-11">
								<div class="input-group">
									<input type="text" v-model="ccategory" id="ccategory" class="form-control" aria-label="...">
									<div class="input-group-btn">
										<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"
										 aria-expanded="false">选择分类 <span class="caret"></span></button>
										<ul class="dropdown-menu dropdown-menu-right">
											<li v-for="c in ccategorys" @click="selectCategroy(c)"><a href="#">{{c}}</a></li>
										</ul>
									</div><!-- /btn-group -->
								</div><!-- /input-group -->
							</div>
						</div>

						<div class="form-group">
							<label for="inputPassword3" class="col-sm-1 control-label">HTML: </label>
							<div class="col-sm-11">
								<textarea v-model="html" rows="15" class="form-control" id="inputPassword3" placeholder="Password"></textarea>
							</div>
						</div>

						<div class="form-group">
							<div class="col-sm-offset-1 col-sm-10">
								<button v-bind:disabled="submitBtn" type="submit" class="btn btn-success">保存</button>
							</div>
						</div>
					</form>
				</div>
			</div>
		</div>

		<script src="../modules/jquery-2.1.0.js"></xscript>
		<script src="../modules/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
		<script src="../modules/module.js"></script>
		<!--
			//vue与jquery在事件绑定上有冲突,这里的示范并不良好
			//如果实在要用请不要使用jquery绑定事件
		-->
		<script src="../modules/vue/vue.js" type="text/javascript" charset="utf-8"></script>
		<script src="../modules/vue/vue-resource.min.js" type="text/javascript" charset="utf-8"></script>
		<script>
			var cedit = new Vue({
				el: "#cedit",
				beforeCreate: function() {
					//console.log("1.组件创建前,可以添加loading效果")
				},
				data: {
					title: "正文编辑",
					cname: "正文编辑",
					ccategory: "正文编辑",
					ccategorys: [
						"1", "2", "3", "4", "5"
					],
					html: "<h1>hello world!<h1/>",
					submitBtn:false
				},
				methods: {
					get: function() {
						//3.方法初始化
					},
					selectCategroy: function(text) {
						this.ccategory = text;
					},
					submitContext: function() {
						this.submitBtn = true
						this.$http.post('/admin/context', JSON.stringify({
							title: this.cname,
							category: this.ccategory,
							html: this.html
						}), {
							emulateJSON: true
						}).then(function(res) {
							console.log(res)
							cedit.submitBtn = false
						})
					}
				},
				created: function() {
					// console.log("4.组件已创建,但dom还未初始化,")
					// console.log("	a.可以在这里取消loading效果")
					// console.log("	b.可以初始化data数据,比如在cookie/localStorage中读取数据赋值给data")
				},
				beforeMount: function() {
					// console.log("5.组件模板挂载前")
					// console.log("	a.初始化dom挂在数据")
				},
				mounted: function() {
					// console.log("6.组件模板挂载后,但不保证已在docment中")
					// console.log("	a.dom挂在后的更新")
					
					//初始化正文分类,可缓存正文内容
					this.ccategorys = [
						'新闻',
						'行业',
						'前言分析'
					];
				},
				beforeUpdate: function() {
					// console.log("视图显示中 i.组件更新前")
					// console.log("	a.统一视图初始化数据")
				},
				updated: function() {
					// console.log("视图显示中 ii.组件更新后")
					// console.log("	a.统一视图修改")
				},
				beforeDestroy: function() {
					console.log("7.组件销毁前")
					console.log("	a.数据本地化存储,比如:写入cookis/localStorage")
				},
				destroyed: function() {
					// console.log("7.组件销毁后")
				}
			})
		</script>
	</body>
</html>
